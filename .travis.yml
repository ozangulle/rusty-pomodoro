os:
- linux
language: rust
rust:
  - stable

global:
  - CRATE_NAME=rusty-pomodoro

matrix:
  include:
    # OSX
    - env: 
      - NAME=rusty-pomodoro
      - TARGET=x86_64-apple-darwin
      - PACKAGE=${NAME}-${TARGET}.tar.gz
      os: osx
    # Windows
    - env:
      - NAME=rusty-pomodoro 
      - TARGET=x86_64-pc-windows-msvc
      - PACKAGE=${NAME}-${TARGET}.tar.gz
      os: ubuntu

before_install:
  - set -e
  - sudo apt-get install -y gcc-multilib
  - rustup self update
  - rustup install stable-gnu
  - rustup target add $TARGET

before_deploy:
  ci/before_deploy.sh

#deploy:
#  provider: releases
#  file: $PACKAGE
#  skip_cleanup: true
#  api_key:
#    secure: $GHKEY
#  on:
#    tags: true
#    repo: ozangulle/rusty-pomodoro
  
cache: cargo
before_cache:
  # Travis can't cache files that are not readable by "others"
  - chmod -R a+r $HOME/.cargo

notifications:
  email:
    on_success: never